---
title: "[GAS] Google Apps Script ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹" # è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«
emoji: "ðŸ“§" # Choose an appropriate emoji for each article
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢è¨˜äº‹
topics: ["JavaScript", "GoogleAppsScript", "GAS", "Gmail", "GmailApi"] # ã‚¿ã‚°ã€‚["markdown", "rust", "aws"]ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹
published: true # å…¬é–‹è¨­å®šï¼ˆfalseã«ã™ã‚‹ã¨ä¸‹æ›¸ãï¼‰
---
# ã“ã‚Œãªã«

ã¡ã‚‡ã³ã¡ã‚‡ã³ãŠä»•äº‹ã•ã›ã¦ã„ãŸã ã„ã¦ã„ãŸãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã•ã‚“ã‹ã‚‰ã€Œå–å¼•å…ˆã«å®šåž‹æ–‡ã‚’å…¥ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚’é€ã‚ŠãŸã„ã€ã¨ã„ã†è¦æœ›ãŒã‚ãŒã‚Šã€ã€Œãƒ©ã‚¤ãƒˆã«ä½œã‚‹ãªã‚‰ GAS ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ã‚’é€ã‚ã†ã‹ãªã€ã¨æ€ã„ç«‹ã¡ã€ãã®éš›ã« GAS ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ã£ã¦ã©ã†ã‚„ã£ã¦é€ã‚‹ã‚“ã ã£ã‘ã¨ã„ã†ã‚‚ã®ã‚’èª¿ã¹ãŸã®ã§ã€ã‚ˆãä½¿ã„ãã†ãªã‚‚ã®ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

â€» [2023å¹´7æœˆé ƒã« note ã«æ›¸ã„ãŸè¨˜äº‹](https://note.com/su3_hokkaido/n/n6213a6dec475)ã‚’ç§»è¡Œã—ãŸã ã‘ãªã®ã§ã™ãŒã€åŸºæœ¬çš„ã«ã¯å¤‰ã‚ã£ã¦ã„ãªã„ã¯ãšã€‚ãŸã ã€ã‚‚ã—ã‹ã—ãŸã‚‰ç´°ã‹ã„ã¨ã“ã‚ãŒå¤‰ã‚ã£ã¦ã„ã‚‹å¯èƒ½æ€§ã‚ã‚‹ã®ã§ãã®ç‚¹ã¯ã”å®¹èµ¦ãã ã•ã„ã€‚

# ä¸€ç•ªç°¡å˜ãªé€ã‚Šæ–¹

å®›å…ˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ä»¶åã€æœ¬æ–‡ã‚’è¨­å®šã—ã¦é€ã‚Šã¾ã™ã€‚é€ä¿¡å…ƒã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ Permission ã‚’è¨±å¯ã—ãŸ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã® Gmail ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¨­å®šã•ã‚Œã¾ã™ã€‚

```js
function sendEmail() {
  let to = "sample@gmail.com";
  let subject = "ãƒ†ã‚¹ãƒˆä»¶å";
  let body = "æœ¬æ–‡ã§ã™";

  GmailApp.sendEmail(to, subject, body);
}
```

# é€ä¿¡å…ƒã‚’å¤‰æ›´ã™ã‚‹

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ optional ã«é€ä¿¡å…ƒã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã—ã‹ä½¿ã†ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚

```js
function sendEmail() {
  let to = "sample@gmail.com";
  let subject = "ãƒ†ã‚¹ãƒˆä»¶å";
  let body = "é€ä¿¡å…ƒã‚’è¨­å®šã—ã¦ã¿ã¾ã—ãŸ";
  let options = {from: "all@gmail.com"};

  GmailApp.sendEmail(to, subject, body, options);
}
```

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2819748/c23edcf6-e7e6-4cc4-b3d5-ae45aeb24b2f.png)

ã“ã‚Œã¯ Gmail ã® Settings => All settings => Accounts and import ã‚¿ãƒ–ã¸ç§»å‹•ã—ã€Add another email address ã‹ã‚‰é€ä¿¡å…ƒã«è¨­å®šã—ãŸã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦è¨­å®šã™ã‚Œã°OKã€‚
ãŸã ã—ã€æœ¬å½“ã«è¨­å®šã§ãã‚‹ã‹ã©ã†ã‹ã‚’è¨­å®šã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«å¯¾ã—ã¦ Verification code ã‚’é€ã£ã¦ãã‚‹ã®ã§ã€ãã® Verification code ã‚’å…¥åŠ›ã—ãªã„ã¨è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ããªã„ã§ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2819748/86288775-5248-433e-89dd-da194303ba65.png)

# CC ã¾ãŸã¯ BCC ã‚’è¨­å®šã™ã‚‹

options ã« CC, BCC ã®é …ç›®ã‚’è¿½åŠ ã™ã‚‹ã¨é€ä¿¡ã§ãã¾ã™ã€‚

```js
function sendEmail() {
  let to = "sample@gmail.com";
  let subject = "ãƒ†ã‚¹ãƒˆä»¶å";
  let body = "CC, BCCã‚’è¨­å®šã—ã¦ã¿ã¾ã—ãŸ";
  let options = {from: "all@gmail.com"
                , cc: "a1@gmail.com"
                , bcc: "b1@gmail.com"};

  GmailApp.sendEmail(to, subject, body, options);
}
```

# è¤‡æ•°ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é€ä¿¡å…ˆã¨ã—ã¦è¨­å®šã™ã‚‹

to, cc, bcc ã„ãšã‚Œã‚‚é…åˆ—ã«ã™ã‚Œã°è§£æ±ºã—ã¾ã™ã€‚

```js
function sendEmail() {
  let to = ["sample1@gmail.com","sample2@gmail.com","sample3@gmail.com"];
  let subject = "ãƒ†ã‚¹ãƒˆä»¶å";
  let body = "å®›å…ˆã‚’è¤‡æ•°è¨­å®šã—ã¦ã¿ã¾ã—ãŸ";
  let options = {from: "all@gmail.com"
                , cc: ["a1@gmail.com","a2@gmail.com","a3@gmail.com"]
                , bcc: ["b1@gmail.com","b2@gmail.com","b3@gmail.com"]};

  GmailApp.sendEmail(to, subject, body, options);
}
```

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã™ã‚‹

attachments ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã¨æ·»ä»˜å¯èƒ½ã§ã™ã€‚é…åˆ—å½¢å¼ã«ã—ã¦æ·»ä»˜ã™ã‚Œã°è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚é€ä»˜å¯èƒ½ã€‚

```js
function sendEmail() {
  let to = ["sample1@gmail.com","sample2@gmail.com","sample3@gmail.com"];
  let subject = "ãƒ†ã‚¹ãƒˆä»¶å";
  let body = "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ã¦ã¿ã¾ã—ãŸ";
  let attachedImg = DriveApp.getFileById("1u5u7yi9TCVLRyS_gVaVT0vUSSKgMfgty").getAs(MimeType.PNG);
  let options = {from: "all@gmail.com"
                , cc: ["a1@gmail.com","a2@gmail.com","a3@gmail.com"]
                , bcc: ["b1@gmail.com","b2@gmail.com","b3@gmail.com"]
                , attachments: [attachedImg]};

  GmailApp.sendEmail(to, subject, body, options);
}
```

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹ã«ã¯ GAS ã‚’å®Ÿè¡Œã™ã‚‹ Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã® Google Drive ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã§æŒ‡å®šã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®IDã¯å…±æœ‰ãƒªãƒ³ã‚¯ã‹ã‚‰å–å¾—ã—ã¾ã—ã‚‡ã†ã€‚ãªãŠã€å…±æœ‰ãƒªãƒ³ã‚¯ã¯ä»¥ä¸‹ã®å½¢å¼ã§ç™ºè¡Œã•ã‚Œã¾ã™ãŒã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚³ãƒ¼ãƒ‰å†…ã§æŒ‡å®šã—ã¦ã„ã‚‹IDã¯ abc123 ã®éƒ¨åˆ†ã§ã™ã€‚

`https://drive.google.com/file/d/abc123/view?usp=sharing`

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/2819748/4ecc92ec-a00e-4ab6-b950-98dcf72d755a.png)

ã¾ãŸã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã™ã‚‹éš›ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä»£è¡¨çš„ãªã‚‚ã®ã‚’åˆ—æŒ™ã—ã¦ãŠãã¾ã™ã€‚

```text
JPEG // .jpg å½¢å¼
PNG // .png å½¢å¼
SVG // .svg å½¢å¼
PDF // .pdf å½¢å¼
ZIP // .zip å½¢å¼
CSV // .csv å½¢å¼
MICROSOFT_EXCEL // é€šå¸¸ã®Excel, .xlsx å½¢å¼
MICROSOFT_EXCEL_LEGACY // æ˜”ã®Excel, .xls å½¢å¼
MICROSOFT_POWERPOINT // é€šå¸¸ã® PowerPoint, .pptx å½¢å¼
MICROSOFT_POWERPOINT_LEGACY // æ˜”ã® PowerPoint, .ppt å½¢å¼
MICROSOFT_WORD // é€šå¸¸ã® Word, .docx å½¢å¼
MICROSOFT_WORD_LEGACY // æ˜”ã® Word, .doc å½¢å¼
```

# ä»Šå›žå‚è€ƒã«ã—ãŸãƒšãƒ¼ã‚¸

- [Workspace > Apps Script > Class Gmail App](https://developers.google.com/apps-script/reference/gmail/gmail-app)
- [Workspace > Apps Script > Enum MimeType](https://developers.google.com/apps-script/reference/base/mime-type)
